2.4 Installing MCenter Agent on Bare Metal
==========================================

This section describes MCenter's bare-metal installation for agents. The bare-metal version of the agent can
be used to communicate with "engines" that run as simple processes in a non-containerized environment, for example,
a TensorFlow process that runs on a GCP node.

Note that the MCenter server should still run in a Docker container, as described in the section [Installing MCenter from Docker Images](./2_1.md).

## Installation

 All necessary packages are available in the tarball `pm-MCenter-<version>.tar.gz`.

### Unpack the Software

Perform the untar of the binaries on each of the nodes that will be included in the MCenter configuration.
```bash
       scp <user-name>@<hostname>://<location>/pm-MCenter-<version>.tgz  .
       tar -xvf pm-MCenter-<version>.tgz
```

### Install Prerequisites
MCenter requires some libraries to be installed for its installer to work. Please run following script:
```bash
    deployutils/mcenter-prerequisites.sh
```

### Configure
Customize the configuration for each agent node by editing the `installer.cfg` file extracted from the tar file.
You can refer sample [installer.cfg](./2_5.md) file.

First, identify the compute node that will be the MCenter server by hostname or IP.
Next, identify the compute node(s) that will be the MCenter agents(s) by hostname or IP.
Determine the install path (INSTALL_DIR, for example, /opt/parallelm). In cases of shared mount points
across the nodes, prefix/suffix the destination directory with hostname or another unique identifier to ensure
each node has the appropriate configuration file (for example, /share-dir/parallelm_HOSTNAME).

The following settings are required:

- MCenterAgent
- installation_path
- sql_db_host
- sql_db_port
- sql_db_user
- sql_db_password
- sql_db_database
- zookeeper_peers

In addition, if you plan to run TensorFlow, the following settings may be required to set the environment correctly:

- tensorflow_python
- tensorflow_path
- tensorflow_ld_library_path

Other settings may use the default values.

Please refer sample [installer.cfg](./2_5.md)

### Install MCenter Agent

Run the installer on the MCenter agent node(s). Agree to the license by typing “I agree”.
Example output from the installer is shown below. Note: for Release 1.3.0, the licensing terms are covered by the Evaluation License, which is provided separately to customers, and as such no content is included here. In future releases, licensing text will be added at this stage of the installation.

```
$ ./installer install
This is the license of the ParallelM MCenter


Please agree to the license above by typing 'I agree': I agree

Installing on local node. . . . . . . . . .

Installation finished successfully.
Parallel M MCenter was installed at <install_path>
```

At this point, the installation is complete.

## Start / Stop MCenter Agent

### Start the Agent

Run the following to start the services on MCenter Agent node(s).
```bash
$ cd INSTALL_PATH/mcenter

$ ./mcenterctl/bin/mcenterctl start
PM MCenter starting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . done
```

### Verify Status

To verify the agent's status, use the following command on the agent.
```bash
$ cd INSTALL_PATH/mcenter

$ ./mcenterctl/bin/mcenterctl status
PM MCenter status check . . MCenter is running
done
```

### Stop MCenter
When you wish to end the job, you can stop the MCenter service using the following command:
```bash
$ cd INSTALL_PATH/mcenter

$ ./mcenterctl/bin/mcenterctl stop
PM MCenter stopping . . . . . . . done
```

## Uninstall
To uninstall MCenter, stop all services and remove the packages using the commands below.

```bash
$ cd pm-MCenter-<version>;
$ ./installer uninstall

Uninstalling on local node .

ParallelM MCenter was uninstalled successfully.
```

